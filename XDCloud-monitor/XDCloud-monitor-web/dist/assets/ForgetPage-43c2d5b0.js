import"./base-3c5e1f2d.js";import{a as te,b as ae,E as le}from"./el-input-e755fe7e.js";import{E as oe,a as ne}from"./el-col-30f14d01.js";import{C as L,E as re}from"./el-button-a220bfc2.js";/* empty css                */import{C as ie,D as pe,g as J,F as Q,h as D,u as X,G as O,H as ue,o as _,c as S,m as T,n as f,k as s,q as Y,I as Z,i as de,t as E,J as ce,K as me,L as ve,j as y,v as ee,l as b,a as c,M as A,d as R,w as o,e as fe,E as U,b as l,N as _e,O as ge,P as q,B as I,s as he,Q as ye,T as G,R as we,S as Se,z as H,U as xe,V as M,W as K,A as Ee}from"./index-b0e8aca7.js";import{f as Ce}from"./vnode-cd11beef.js";const Ve=(h,m,e)=>Ce(h.subTree).filter(n=>{var t;return pe(n)&&((t=n.type)==null?void 0:t.name)===m&&!!n.component}).map(n=>n.component.uid).map(n=>e[n]).filter(n=>!!n),ke=(h,m)=>{const e={},u=ie([]);return{children:u,addChild:t=>{e[t.uid]=t,u.value=Ve(h,m,e)},removeChild:t=>{delete e[t],u.value=u.value.filter(r=>r.uid!==t)}}},be=J({space:{type:[Number,String],default:""},active:{type:Number,default:0},direction:{type:String,default:"horizontal",values:["horizontal","vertical"]},alignCenter:{type:Boolean},simple:{type:Boolean},finishStatus:{type:String,values:["wait","process","finish","error","success"],default:"finish"},processStatus:{type:String,values:["wait","process","finish","error","success"],default:"process"}}),$e={[L]:(h,m)=>[h,m].every(Q)},Ne=D({name:"ElSteps"}),Ie=D({...Ne,props:be,emits:$e,setup(h,{emit:m}){const e=h,u=X("steps"),{children:g,addChild:n,removeChild:t}=ke(Z(),"ElStep");return O(g,()=>{g.value.forEach((r,v)=>{r.setIndex(v)})}),ue("ElSteps",{props:e,steps:g,addStep:n,removeStep:t}),O(()=>e.active,(r,v)=>{m(L,r,v)}),(r,v)=>(_(),S("div",{class:f([s(u).b(),s(u).m(r.simple?"simple":r.direction)])},[T(r.$slots,"default")],2))}});var Be=Y(Ie,[["__file","/home/runner/work/element-plus/element-plus/packages/components/steps/src/steps.vue"]]);const Pe=J({title:{type:String,default:""},icon:{type:de},description:{type:String,default:""},status:{type:String,values:["","wait","process","finish","error","success"],default:""}}),ze=D({name:"ElStep"}),Re=D({...ze,props:Pe,setup(h){const m=h,e=X("step"),u=E(-1),g=E({}),n=E(""),t=ce("ElSteps"),r=Z();me(()=>{O([()=>t.props.active,()=>t.props.processStatus,()=>t.props.finishStatus],([a])=>{N(a)},{immediate:!0})}),ve(()=>{t.removeStep(z.uid)});const v=y(()=>m.status||n.value),F=y(()=>{const a=t.steps.value[u.value-1];return a?a.currentStatus:"wait"}),$=y(()=>t.props.alignCenter),B=y(()=>t.props.direction==="vertical"),p=y(()=>t.props.simple),i=y(()=>t.steps.value.length),w=y(()=>{var a;return((a=t.steps.value[i.value-1])==null?void 0:a.uid)===(r==null?void 0:r.uid)}),x=y(()=>p.value?"":t.props.space),C=y(()=>[e.b(),e.is(p.value?"simple":t.props.direction),e.is("flex",w.value&&!x.value&&!$.value),e.is("center",$.value&&!B.value&&!p.value)]),V=y(()=>{const a={flexBasis:Q(x.value)?`${x.value}px`:x.value?x.value:`${100/(i.value-($.value?0:1))}%`};return B.value||w.value&&(a.maxWidth=`${100/i.value}%`),a}),k=a=>{u.value=a},P=a=>{const d=a==="wait",W={transitionDelay:`${d?"-":""}${150*u.value}ms`},j=a===t.props.processStatus||d?0:100;W.borderWidth=j&&!p.value?"1px":0,W[t.props.direction==="vertical"?"height":"width"]=`${j}%`,g.value=W},N=a=>{a>u.value?n.value=t.props.finishStatus:a===u.value&&F.value!=="error"?n.value=t.props.processStatus:n.value="wait";const d=t.steps.value[u.value-1];d&&d.calcProgress(n.value)},z=ee({uid:r.uid,currentStatus:v,setIndex:k,calcProgress:P});return t.addStep(z),(a,d)=>(_(),S("div",{style:A(s(V)),class:f(s(C))},[b(" icon & line "),c("div",{class:f([s(e).e("head"),s(e).is(s(v))])},[s(p)?b("v-if",!0):(_(),S("div",{key:0,class:f(s(e).e("line"))},[c("i",{class:f(s(e).e("line-inner")),style:A(g.value)},null,6)],2)),c("div",{class:f([s(e).e("icon"),s(e).is(a.icon||a.$slots.icon?"icon":"text")])},[T(a.$slots,"icon",{},()=>[a.icon?(_(),R(s(U),{key:0,class:f(s(e).e("icon-inner"))},{default:o(()=>[(_(),R(fe(a.icon)))]),_:1},8,["class"])):s(v)==="success"?(_(),R(s(U),{key:1,class:f([s(e).e("icon-inner"),s(e).is("status")])},{default:o(()=>[l(s(_e))]),_:1},8,["class"])):s(v)==="error"?(_(),R(s(U),{key:2,class:f([s(e).e("icon-inner"),s(e).is("status")])},{default:o(()=>[l(s(ge))]),_:1},8,["class"])):s(p)?b("v-if",!0):(_(),S("div",{key:3,class:f(s(e).e("icon-inner"))},q(u.value+1),3))])],2)],2),b(" title & description "),c("div",{class:f(s(e).e("main"))},[c("div",{class:f([s(e).e("title"),s(e).is(s(v))])},[T(a.$slots,"title",{},()=>[I(q(a.title),1)])],2),s(p)?(_(),S("div",{key:0,class:f(s(e).e("arrow"))},null,2)):(_(),S("div",{key:1,class:f([s(e).e("description"),s(e).is(s(v))])},[T(a.$slots,"description",{},()=>[I(q(a.description),1)])],2))],2)],6))}});var se=Y(Re,[["__file","/home/runner/work/element-plus/element-plus/packages/components/steps/src/item.vue"]]);const Te=he(Be,{Step:se}),Ue=ye(se);const qe={style:{margin:"30px 20px"}},De={key:0,style:{"text-align":"center",margin:"0 20px",height:"100%"}},Fe=c("div",{style:{"margin-top":"80px"}},[c("div",{style:{"font-size":"25px","font-weight":"bold"}},"重置密码"),c("div",{style:{"font-size":"14px",color:"grey"}},"请输入需要重置密码的电子邮件地址")],-1),We={style:{"margin-top":"50px"}},Me={style:{"margin-top":"70px"}},Oe={key:0,style:{"text-align":"center",margin:"0 20px",height:"100%"}},je=c("div",{style:{"margin-top":"80px"}},[c("div",{style:{"font-size":"25px","font-weight":"bold"}},"重置密码"),c("div",{style:{"font-size":"14px",color:"grey"}},"请填写您的新密码，务必牢记，防止丢失")],-1),Ae={style:{"margin-top":"50px"}},Ge={style:{"margin-top":"70px"}},Ze={__name:"ForgetPage",setup(h){const m=E(0),e=ee({email:"",code:"",password:"",password_repeat:""}),g={email:[{required:!0,message:"请输入邮件地址",trigger:"blur"},{type:"email",message:"请输入合法的电子邮件地址",trigger:["blur","change"]}],code:[{required:!0,message:"请输入获取的验证码",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:16,message:"密码的长度必须在6-16个字符之间",trigger:["blur"]}],password_repeat:[{validator:(p,i,w)=>{i===""?w(new Error("请再次输入密码")):i!==e.password?w(new Error("两次输入的密码不一致")):w()},trigger:["blur","change"]}]},n=E(),t=E(!1),r=E(0),v=(p,i)=>{p==="email"&&(t.value=i)},F=()=>{r.value=60,xe(`/api/auth/ask-code?email=${e.email}&type=reset`,()=>{M.success(`验证码已发送到邮箱: ${e.email}，请注意查收`);const p=setInterval(()=>{r.value--,r.value===0&&clearInterval(p)},1e3)},p=>{M.warning(p),r.value=0})},$=()=>{n.value.validate(p=>{p&&K("/api/auth/reset-confirm",{email:e.email,code:e.code},()=>m.value++)})},B=()=>{n.value.validate(p=>{p&&K("/api/auth/reset-password",{email:e.email,code:e.code,password:e.password},()=>{M.success("密码重置成功，请重新登录"),Ee.push("/")})})};return(p,i)=>{const w=Ue,x=Te,C=U,V=te,k=ae,P=oe,N=re,z=ne,a=le;return _(),S("div",null,[c("div",qe,[l(x,{active:m.value,"finish-status":"success","align-center":""},{default:o(()=>[l(w,{title:"验证电子邮件"}),l(w,{title:"重新设定密码"})]),_:1},8,["active"])]),l(G,{name:"el-fade-in-linear",mode:"out-in"},{default:o(()=>[m.value===0?(_(),S("div",De,[Fe,c("div",We,[l(a,{model:e,rules:g,onValidate:v,ref_key:"formRef",ref:n},{default:o(()=>[l(k,{prop:"email"},{default:o(()=>[l(V,{modelValue:e.email,"onUpdate:modelValue":i[0]||(i[0]=d=>e.email=d),type:"email",placeholder:"电子邮件地址"},{prefix:o(()=>[l(C,null,{default:o(()=>[l(s(we))]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(k,{prop:"code"},{default:o(()=>[l(z,{gutter:10,style:{width:"100%"}},{default:o(()=>[l(P,{span:17},{default:o(()=>[l(V,{modelValue:e.code,"onUpdate:modelValue":i[1]||(i[1]=d=>e.code=d),maxlength:6,type:"text",placeholder:"请输入验证码"},{prefix:o(()=>[l(C,null,{default:o(()=>[l(s(Se))]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(P,{span:5},{default:o(()=>[l(N,{type:"success",onClick:F,disabled:!t.value||r.value>0},{default:o(()=>[I(q(r.value>0?"请稍后 "+r.value+" 秒":"获取验证码"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),c("div",Me,[l(N,{onClick:i[2]||(i[2]=d=>$()),style:{width:"270px"},type:"danger",plain:""},{default:o(()=>[I("开始重置密码")]),_:1})])])):b("",!0)]),_:1}),l(G,{name:"el-fade-in-linear",mode:"out-in"},{default:o(()=>[m.value===1?(_(),S("div",Oe,[je,c("div",Ae,[l(a,{model:e,rules:g,onValidate:v,ref_key:"formRef",ref:n},{default:o(()=>[l(k,{prop:"password"},{default:o(()=>[l(V,{modelValue:e.password,"onUpdate:modelValue":i[3]||(i[3]=d=>e.password=d),maxlength:16,type:"password",placeholder:"新密码"},{prefix:o(()=>[l(C,null,{default:o(()=>[l(s(H))]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(k,{prop:"password_repeat"},{default:o(()=>[l(V,{modelValue:e.password_repeat,"onUpdate:modelValue":i[4]||(i[4]=d=>e.password_repeat=d),maxlength:16,type:"password",placeholder:"重复新密码"},{prefix:o(()=>[l(C,null,{default:o(()=>[l(s(H))]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),c("div",Ge,[l(N,{onClick:i[5]||(i[5]=d=>B()),style:{width:"270px"},type:"danger",plain:""},{default:o(()=>[I("立即重置密码")]),_:1})])])):b("",!0)]),_:1})])}}};export{Ze as default};
